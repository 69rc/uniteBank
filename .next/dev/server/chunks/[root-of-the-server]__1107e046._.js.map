{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///Users/bashirmuhammadjibrin/Documents/uniteBank/shared/schema.ts"],"sourcesContent":["import { pgTable, text, serial, integer, boolean, timestamp, numeric, varchar, date } from \"drizzle-orm/pg-core\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\n\nexport const users = pgTable(\"users\", {\n  id: serial(\"id\").primaryKey(),\n  firstName: text(\"first_name\").notNull(),\n  lastName: text(\"last_name\").notNull(),\n  otherName: text(\"other_name\"),\n  email: text(\"email\").notNull().unique(),\n  phone: text(\"phone\").notNull(),\n  dob: date(\"dob\").notNull(),\n  gender: text(\"gender\").notNull(),\n  nationality: text(\"nationality\").notNull(),\n  \n  // Contact info\n  address: text(\"address\").notNull(),\n  city: text(\"city\").notNull(),\n  state: text(\"state\").notNull(),\n  country: text(\"country\").notNull(),\n  zipCode: text(\"zip_code\").notNull(),\n  \n  // KYC\n  idType: text(\"id_type\").notNull(), // National ID, Passport, etc.\n  idNumber: text(\"id_number\").notNull(),\n  idExpiryDate: date(\"id_expiry_date\").notNull(),\n  idImageUrl: text(\"id_image_url\"),\n  selfieUrl: text(\"selfie_url\"),\n  \n  // Account Info\n  accountType: text(\"account_type\", { enum: [\"SAVINGS\", \"CURRENT\", \"CHECKING\"] }).notNull(),\n  currency: text(\"currency\").default(\"USD\").notNull(),\n  accountPurpose: text(\"account_purpose\"),\n  \n  // Security\n  password: text(\"password\").notNull(),\n  transactionPin: text(\"transaction_pin\").notNull(), // 4-6 digits\n  \n  // Status & Role\n  role: text(\"role\", { enum: [\"USER\", \"ADMIN\"] }).default(\"USER\").notNull(),\n  status: text(\"status\", { enum: [\"PENDING\", \"APPROVED\", \"REJECTED\"] }).default(\"PENDING\").notNull(),\n  isEmailVerified: boolean(\"is_email_verified\").default(false).notNull(),\n  \n  // Generated fields\n  accountNumber: varchar(\"account_number\", { length: 20 }).unique(), \n  customerId: varchar(\"customer_id\", { length: 15 }).unique(), // Auto-generated customer ID\n  balance: numeric(\"balance\", { precision: 12, scale: 2 }).default(\"0.00\").notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const otps = pgTable(\"otps\", {\n  id: serial(\"id\").primaryKey(),\n  email: text(\"email\").notNull(),\n  code: text(\"code\").notNull(),\n  purpose: text(\"purpose\").default(\"EMAIL_VERIFICATION\").notNull(),\n  expiresAt: timestamp(\"expires_at\").notNull(),\n});\n\nexport const transactions = pgTable(\"transactions\", {\n  id: serial(\"id\").primaryKey(),\n  userId: integer(\"user_id\").references(() => users.id).notNull(),\n  type: text(\"type\", { enum: [\"CREDIT\", \"DEBIT\"] }).notNull(),\n  amount: numeric(\"amount\", { precision: 12, scale: 2 }).notNull(),\n  description: text(\"description\").notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  createdBy: text(\"created_by\", { enum: [\"SYSTEM\", \"ADMIN\"] }).default(\"SYSTEM\").notNull(),\n});\n\n// Schemas\nexport const insertUserSchema = createInsertSchema(users).omit({ \n  id: true, \n  createdAt: true, \n  accountNumber: true, \n  customerId: true,\n  balance: true,\n  role: true, \n  status: true,\n  isEmailVerified: true\n}).extend({\n  password: z.string().min(8),\n  transactionPin: z.string().min(4).max(6),\n});\n\nexport const insertTransactionSchema = createInsertSchema(transactions).omit({ \n  id: true, \n  createdAt: true \n});\n\n// Types\nexport type User = typeof users.$inferSelect;\nexport type InsertUser = z.infer<typeof insertUserSchema>;\nexport type Transaction = typeof transactions.$inferSelect;\nexport type InsertTransaction = z.infer<typeof insertTransactionSchema>;\n\n// Auth types\nexport const loginSchema = z.object({\n  email: z.string().email(),\n  password: z.string(),\n});\n\nexport const otpSchema = z.object({\n  email: z.string().email(),\n  code: z.string().length(6),\n});\n\nexport type LoginRequest = z.infer<typeof loginSchema>;\nexport type OtpRequest = z.infer<typeof otpSchema>;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 193, "column": 0}, "map": {"version":3,"sources":["file:///Users/bashirmuhammadjibrin/Documents/uniteBank/server/db.ts"],"sourcesContent":["import { drizzle } from \"drizzle-orm/node-postgres\";\nimport pg from \"pg\";\nimport * as schema from \"@shared/schema\";\n\nconst { Pool } = pg;\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\n    \"DATABASE_URL must be set. Did you forget to provision a database?\",\n  );\n}\n\n// Configure SSL for Supabase\nconst useSSL = process.env.DATABASE_URL.includes('supabase.co');\n\nexport const pool = new Pool({\n  connectionString: process.env.DATABASE_URL,\n  ...(useSSL && { ssl: { rejectUnauthorized: false } }),\n});\nexport const db = drizzle(pool, { schema });\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;;;;;;;;;AAEA,MAAM,EAAE,IAAI,EAAE,GAAG,kLAAE;AAEnB,IAAI,CAAC,QAAQ,GAAG,CAAC,YAAY,EAAE;IAC7B,MAAM,IAAI,MACR;AAEJ;AAEA,6BAA6B;AAC7B,MAAM,SAAS,QAAQ,GAAG,CAAC,YAAY,CAAC,QAAQ,CAAC;AAE1C,MAAM,OAAO,IAAI,KAAK;IAC3B,kBAAkB,QAAQ,GAAG,CAAC,YAAY;IAC1C,GAAI,UAAU;QAAE,KAAK;YAAE,oBAAoB;QAAM;IAAE,CAAC;AACtD;AACO,MAAM,KAAK,IAAA,mMAAO,EAAC,MAAM;IAAE,QAAA;AAAO"}},
    {"offset": {"line": 234, "column": 0}, "map": {"version":3,"sources":["file:///Users/bashirmuhammadjibrin/Documents/uniteBank/server/storage.ts"],"sourcesContent":["import { users, otps, transactions, type User, type InsertUser, type Transaction, type InsertTransaction } from \"@shared/schema\";\nimport { db } from \"./db\";\nimport { eq, desc, and } from \"drizzle-orm\";\n\nexport interface IStorage {\n  // Users\n  getUser(id: number): Promise<User | undefined>;\n  getUserByEmail(email: string): Promise<User | undefined>;\n  createUser(user: any): Promise<User>;\n  updateUserStatus(id: number, status: \"PENDING\" | \"APPROVED\" | \"REJECTED\"): Promise<User | undefined>;\n  updateUserBalance(id: number, balance: string): Promise<User | undefined>;\n  getAllUsers(): Promise<User[]>;\n  updateUserAccountNumber(id: number, accountNumber: string): Promise<User | undefined>;\n  verifyUserEmail(email: string): Promise<void>;\n  updateUserPassword(id: number, password: string): Promise<void>;\n\n  // OTPs\n  createOtp(email: string, code: string, purpose?: \"EMAIL_VERIFICATION\" | \"PASSWORD_RESET\"): Promise<void>;\n  verifyOtp(email: string, code: string, purpose?: \"EMAIL_VERIFICATION\" | \"PASSWORD_RESET\"): Promise<boolean>;\n\n  // Transactions\n  createTransaction(transaction: InsertTransaction): Promise<Transaction>;\n  getTransactionsByUserId(userId: number): Promise<Transaction[]>;\n  getAllTransactions(): Promise<Transaction[]>;\n}\n\nexport class DatabaseStorage implements IStorage {\n  async getUser(id: number): Promise<User | undefined> {\n    const [user] = await db.select().from(users).where(eq(users.id, id));\n    return user;\n  }\n\n  async getUserByEmail(email: string): Promise<User | undefined> {\n    const [user] = await db.select().from(users).where(eq(users.email, email));\n    return user;\n  }\n\n  async createUser(user: any): Promise<User> {\n    const [newUser] = await db.insert(users).values(user).returning();\n    return newUser;\n  }\n\n  async updateUserStatus(id: number, status: \"PENDING\" | \"APPROVED\" | \"REJECTED\"): Promise<User | undefined> {\n    const [user] = await db.update(users).set({ status }).where(eq(users.id, id)).returning();\n    return user;\n  }\n\n  async updateUserBalance(id: number, balance: string): Promise<User | undefined> {\n    const [user] = await db.update(users).set({ balance }).where(eq(users.id, id)).returning();\n    return user;\n  }\n\n  async updateUserAccountNumber(id: number, accountNumber: string): Promise<User | undefined> {\n    const [user] = await db.update(users).set({ accountNumber }).where(eq(users.id, id)).returning();\n    return user;\n  }\n\n  async verifyUserEmail(email: string): Promise<void> {\n    await db.update(users).set({ isEmailVerified: true }).where(eq(users.email, email));\n  }\n\n  async updateUserPassword(id: number, password: string): Promise<void> {\n    await db.update(users).set({ password }).where(eq(users.id, id));\n  }\n\n  async getAllUsers(): Promise<User[]> {\n    return await db.select().from(users).orderBy(desc(users.createdAt));\n  }\n\n  // OTPs\n  async createOtp(email: string, code: string, purpose: \"EMAIL_VERIFICATION\" | \"PASSWORD_RESET\" = \"EMAIL_VERIFICATION\"): Promise<void> {\n    await db.delete(otps).where(and(eq(otps.email, email), eq(otps.purpose, purpose)));\n    const expiresAt = new Date(Date.now() + 5 * 60 * 1000);\n    await db.insert(otps).values({ email, code, expiresAt, purpose });\n  }\n\n  async verifyOtp(email: string, code: string, purpose: \"EMAIL_VERIFICATION\" | \"PASSWORD_RESET\" = \"EMAIL_VERIFICATION\"): Promise<boolean> {\n    const [otp] = await db\n      .select()\n      .from(otps)\n      .where(and(eq(otps.email, email), eq(otps.purpose, purpose)));\n    if (!otp) return false;\n    if (new Date() > otp.expiresAt) {\n      await db.delete(otps).where(eq(otps.id, otp.id));\n      return false;\n    }\n    if (otp.code !== code) return false;\n    await db.delete(otps).where(eq(otps.id, otp.id));\n    return true;\n  }\n\n  // Transactions\n  async createTransaction(transaction: InsertTransaction): Promise<Transaction> {\n    const [newTx] = await db.insert(transactions).values(transaction).returning();\n    return newTx;\n  }\n\n  async getTransactionsByUserId(userId: number): Promise<Transaction[]> {\n    return await db.select().from(transactions).where(eq(transactions.userId, userId)).orderBy(desc(transactions.createdAt));\n  }\n\n  async getAllTransactions(): Promise<Transaction[]> {\n    return await db.select().from(transactions).orderBy(desc(transactions.createdAt));\n  }\n}\n\nexport const storage = new DatabaseStorage();\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 343, "column": 0}, "map": {"version":3,"sources":["file:///Users/bashirmuhammadjibrin/Documents/uniteBank/app/lib/auth.ts"],"sourcesContent":["import { storage } from '@server/storage';\nimport { comparePasswords } from '../api/utils/auth';\nimport { cookies } from 'next/headers';\n\n// Mock session storage - in production you might use Redis, DB, or JWT\n// Note: This in-memory storage is not suitable for serverless/production environments.\nconst mockSessions = new Map();\n\n// Function to check if user is authenticated\nexport async function isAuthenticated(request: Request) {\n  const sessionId = getSessionIdFromRequest(request);\n  if (!sessionId) {\n    return false;\n  }\n\n  const session = mockSessions.get(sessionId);\n  return !!session;\n}\n\n// Function to check if user is admin\nexport async function isAdmin(request: Request) {\n  const user = await getCurrentUserFromRequest(request);\n  return user && user.role === 'ADMIN';\n}\n\n// Function to get current user from session\nexport async function getCurrentUserFromRequest(request: Request) {\n  const sessionId = getSessionIdFromRequest(request);\n  if (!sessionId) {\n    return null;\n  }\n\n  const session = mockSessions.get(sessionId);\n  if (!session) {\n    return null;\n  }\n\n  // In a real implementation, you would fetch user from your DB\n  const user = await storage.getUser(session.userId);\n  return user;\n}\n\n// Helper function to extract session ID from request\nfunction getSessionIdFromRequest(request: Request): string | undefined {\n  // Look for session ID in cookies\n  const cookieHeader = request.headers.get('cookie');\n  if (!cookieHeader) return undefined;\n\n  const cookies = cookieHeader.split(';').reduce((acc, cookieStr) => {\n    const [key, value] = cookieStr.trim().split('=');\n    acc[key] = value;\n    return acc;\n  }, {} as Record<string, string>);\n\n  return cookies['sessionId'];\n}\n\n// Function to create session ID\nexport function createSessionId(userId: number): string {\n  const sessionId = `session_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n  mockSessions.set(sessionId, { userId, createdAt: new Date() });\n  return sessionId;\n}\n\n// Function to create session and set cookie\nexport async function createSession(userId: number) {\n  const sessionId = createSessionId(userId);\n  const cookieStore = await cookies();\n  cookieStore.set('sessionId', sessionId, {\n    httpOnly: true,\n    secure: process.env.NODE_ENV === 'production',\n    sameSite: 'lax',\n    path: '/',\n    maxAge: 7 * 24 * 60 * 60 // 1 week\n  });\n  return sessionId;\n}\n\n// Function to destroy session\nexport async function destroySession() {\n  const cookieStore = await cookies();\n  const sessionId = cookieStore.get('sessionId')?.value;\n\n  if (sessionId) {\n    mockSessions.delete(sessionId);\n    cookieStore.delete('sessionId');\n  }\n}\n\nexport function destroySessionById(sessionId: string) {\n  mockSessions.delete(sessionId);\n}"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAAA;AAEA;;;;;;;AAEA,uEAAuE;AACvE,uFAAuF;AACvF,MAAM,eAAe,IAAI;AAGlB,eAAe,gBAAgB,OAAgB;IACpD,MAAM,YAAY,wBAAwB;IAC1C,IAAI,CAAC,WAAW;QACd,OAAO;IACT;IAEA,MAAM,UAAU,aAAa,GAAG,CAAC;IACjC,OAAO,CAAC,CAAC;AACX;AAGO,eAAe,QAAQ,OAAgB;IAC5C,MAAM,OAAO,MAAM,0BAA0B;IAC7C,OAAO,QAAQ,KAAK,IAAI,KAAK;AAC/B;AAGO,eAAe,0BAA0B,OAAgB;IAC9D,MAAM,YAAY,wBAAwB;IAC1C,IAAI,CAAC,WAAW;QACd,OAAO;IACT;IAEA,MAAM,UAAU,aAAa,GAAG,CAAC;IACjC,IAAI,CAAC,SAAS;QACZ,OAAO;IACT;IAEA,8DAA8D;IAC9D,MAAM,OAAO,MAAM,wJAAO,CAAC,OAAO,CAAC,QAAQ,MAAM;IACjD,OAAO;AACT;AAEA,qDAAqD;AACrD,SAAS,wBAAwB,OAAgB;IAC/C,iCAAiC;IACjC,MAAM,eAAe,QAAQ,OAAO,CAAC,GAAG,CAAC;IACzC,IAAI,CAAC,cAAc,OAAO;IAE1B,MAAM,UAAU,aAAa,KAAK,CAAC,KAAK,MAAM,CAAC,CAAC,KAAK;QACnD,MAAM,CAAC,KAAK,MAAM,GAAG,UAAU,IAAI,GAAG,KAAK,CAAC;QAC5C,GAAG,CAAC,IAAI,GAAG;QACX,OAAO;IACT,GAAG,CAAC;IAEJ,OAAO,OAAO,CAAC,YAAY;AAC7B;AAGO,SAAS,gBAAgB,MAAc;IAC5C,MAAM,YAAY,CAAC,QAAQ,EAAE,KAAK,GAAG,GAAG,CAAC,EAAE,KAAK,MAAM,GAAG,QAAQ,CAAC,IAAI,MAAM,CAAC,GAAG,IAAI;IACpF,aAAa,GAAG,CAAC,WAAW;QAAE;QAAQ,WAAW,IAAI;IAAO;IAC5D,OAAO;AACT;AAGO,eAAe,cAAc,MAAc;IAChD,MAAM,YAAY,gBAAgB;IAClC,MAAM,cAAc,MAAM,IAAA,sKAAO;IACjC,YAAY,GAAG,CAAC,aAAa,WAAW;QACtC,UAAU;QACV,QAAQ,oDAAyB;QACjC,UAAU;QACV,MAAM;QACN,QAAQ,IAAI,KAAK,KAAK,GAAG,SAAS;IACpC;IACA,OAAO;AACT;AAGO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,sKAAO;IACjC,MAAM,YAAY,YAAY,GAAG,CAAC,cAAc;IAEhD,IAAI,WAAW;QACb,aAAa,MAAM,CAAC;QACpB,YAAY,MAAM,CAAC;IACrB;AACF;AAEO,SAAS,mBAAmB,SAAiB;IAClD,aAAa,MAAM,CAAC;AACtB"}},
    {"offset": {"line": 445, "column": 0}, "map": {"version":3,"sources":["file:///Users/bashirmuhammadjibrin/Documents/uniteBank/app/api/user/route.ts"],"sourcesContent":["import { NextRequest } from 'next/server';\nimport { getCurrentUserFromRequest, isAuthenticated } from '@lib/auth';\n\nexport async function GET(request: NextRequest) {\n  const authenticated = await isAuthenticated(request);\n  if (!authenticated) {\n    return new Response(JSON.stringify({ message: \"Not authenticated\" }), {\n      status: 401,\n      headers: { \"Content-Type\": \"application/json\" }\n    });\n  }\n\n  const user = await getCurrentUserFromRequest(request);\n  return Response.json(user);\n}"],"names":[],"mappings":";;;;AACA;;;;;;AAEO,eAAe,IAAI,OAAoB;IAC5C,MAAM,gBAAgB,MAAM,IAAA,iKAAe,EAAC;IAC5C,IAAI,CAAC,eAAe;QAClB,OAAO,IAAI,SAAS,KAAK,SAAS,CAAC;YAAE,SAAS;QAAoB,IAAI;YACpE,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;QAChD;IACF;IAEA,MAAM,OAAO,MAAM,IAAA,2KAAyB,EAAC;IAC7C,OAAO,SAAS,IAAI,CAAC;AACvB"}}]
}