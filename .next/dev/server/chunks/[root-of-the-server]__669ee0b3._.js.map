{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/bashirmuhammadjibrin/Documents/uniteBank/app/api/auth/captcha/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport { cookies } from 'next/headers';\n\nexport async function GET() {\n    try {\n        // Generate a random 6-digit code\n        const captchaCode = Math.floor(100000 + Math.random() * 900000).toString();\n\n        const cookieStore = await cookies();\n\n        // Set the captcha in a cookie with 5-minute expiry\n        // In a real app, this should be encrypted or hashed\n        cookieStore.set('captcha_code', captchaCode, {\n            httpOnly: true,\n            secure: process.env.NODE_ENV === 'production',\n            sameSite: 'lax',\n            path: '/',\n            maxAge: 300 // 5 minutes\n        });\n\n        return NextResponse.json({ code: captchaCode });\n    } catch (err: any) {\n        console.error(\"Captcha generation error:\", err);\n        return NextResponse.json({ message: \"Failed to generate captcha\" }, { status: 500 });\n    }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe;IAClB,IAAI;QACA,iCAAiC;QACjC,MAAM,cAAc,KAAK,KAAK,CAAC,SAAS,KAAK,MAAM,KAAK,QAAQ,QAAQ;QAExE,MAAM,cAAc,MAAM,IAAA,sKAAO;QAEjC,mDAAmD;QACnD,oDAAoD;QACpD,YAAY,GAAG,CAAC,gBAAgB,aAAa;YACzC,UAAU;YACV,QAAQ,oDAAyB;YACjC,UAAU;YACV,MAAM;YACN,QAAQ,IAAI,YAAY;QAC5B;QAEA,OAAO,0KAAY,CAAC,IAAI,CAAC;YAAE,MAAM;QAAY;IACjD,EAAE,OAAO,KAAU;QACf,QAAQ,KAAK,CAAC,6BAA6B;QAC3C,OAAO,0KAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAA6B,GAAG;YAAE,QAAQ;QAAI;IACtF;AACJ"}}]
}